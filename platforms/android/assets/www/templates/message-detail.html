<ion-view id="messageDetail" view-title={{viewtitle}}>
  <ion-nav-bar align-title="center">

    <ion-nav-buttons side="left">
      <button class="button  button-icon icon ion-ios-arrow-back" ng-click="backFirstMenu()">
        即时通
      </button>
    </ion-nav-buttons>

    <ion-nav-buttons side="right">
      <button class="button button-icon icon ion-ios-telephone" ng-click="call(10086)"></button>
    </ion-nav-buttons>

    <ion-nav-buttons side="secondary">
      <button class="button button-icon icon ion-ios-person-outline" ng-click="personalSetting()"
              style="margin-right: 5px"></button>

    </ion-nav-buttons>

  </ion-nav-bar>

  <ion-content class="rj-stable-content" delegate-handle="messageDetailsScroll"  on-drag="onDrag()">
    <ion-refresher refreshing-icon="ion-loading-c" on-refresh="doRefresh()" refreshing-text="获取数据中..."
                   pulling-text="更多消息" id="refresh">
    </ion-refresher>
    <p style="text-align: center" ng-if="nomore === 'true'" ng-click="skipmessagebox()">更多消息请在历史消息中查阅</p>
    <div>
      <div ng-repeat="msgSingle in msgs">
        <!--对方发送消息时必须判断接收者id是否跟userId一致：聊天对象id-->
        <div class="rj-message-wrap" ng-if="(msgSingle.from==='false') &&(msgSingle.sessionid === userId)">
          <img src="img/mike.png" class="rj-head-pic">
          <span class="rj-triangle-left"></span>
          <p class="rj-message">{{msgSingle.message}}</p>
        </div>
        <div class="rj-message-wrap" ng-if="(msgSingle.from === 'true')">
          <img src="img/ben.png" class="rj-head-pic-right">
          <span class="rj-triangle-right"></span>
           <span>
             <!--<img style="margin-right: 5px;position: relative;right: 0px;" src="img/red.png" align="left">-->
             <p style="float: right;"><img style="vertical-align: middle;" src="img/red.png" ng-if="(msgSingle.isFailure === 'true')"  ng-click="resendshow(userId,msgSingle.message, userId, localusr,msgSingle._id,msgSingle)"><font class="rj-message-right">{{msgSingle.message}}</font></p>
          </span>
        </div>
      </div>
    </div>
  </ion-content>

  <ion-footer-bar align-title="left" class="bar-light" resize-foot-bar>
    <div class="rj-footer-btn-wrap">
      <button class="button button-icon icon ion-ios-mic-outline rj-footer-btn-left">
      </button>
    </div>
    <label class="item item-input rj-footer-input">
      <textarea msd-elastic ng-model="send_content" style="margin-right: 45px;">

      </textarea>
      <div class="buttons">
        <button class="rj-footer-btn button button-icon icon ion-happy-outline"></button>
      </div>
    </label>
    <div class="rj-footer-btn-wrap">
      <div class="buttons" ng-show="!send_content || send_content === ''">
        <button class="button button-icon icon ion-ios-plus-outline rj-footer-btn-left">
        </button>
      </div>
      <div class="rj-send-button" ng-hide="!send_content || send_content === ''"
           ng-click="sendSingleMsg(userId,send_content, userId,localusr,_id)">
        <p>发送</p>
      </div>
    </div>
  </ion-footer-bar>
</ion-view>

