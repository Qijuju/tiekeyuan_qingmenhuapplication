<ion-view  view-title="定位记录" class="common-view-color">
  <ion-nav-bar align-title="center"class="newbarhead">
    <ion-nav-buttons side="left">
      <button class="button  button-icon icon ion-ios-arrow-left common-color-white" ng-click="goSetting()">
        返回
      </button>
    </ion-nav-buttons>
  </ion-nav-bar>



  <ion-content overflow-scroll="false"  delegate-handle="historyScroll" style="background-color:#e5e5e5 ">
    <ion-refresher
      pulling-text="下拉刷新..."
      on-refresh="doRefreshhis()">
    </ion-refresher>

    <div ng-repeat="historyduifangaaa in historyduifangsss">
      <!--对方发送消息时必须判断接收者id是否跟userId一致：聊天对象id-->
      <div class="rj-message-wrap" ng-if="historyduifangaaa.FromID==id && (historyduifangaaa.MsgType=='P')" style="margin-top: 8px">
        <div ng-if="historyduifangaaa.FromID.substring((historyduifangaaa.FromID.length-1),historyduifangaaa.FromID.length)==1||historyduifangaaa.FromID.substring((historyduifangaaa.FromID.length-1),historyduifangaaa.FromID.length)==9" class=" circle1" style=" position: absolute;left: 8px;font-size: 14px;padding-top: 8px">{{historyduifangaaa.FromName.length > 2 ? historyduifangaaa.FromName.substring((historyduifangaaa.FromName.length-2),historyduifangaaa.FromName.length):historyduifangaaa.FromName}}</div>
        <div ng-if="historyduifangaaa.FromID.substring((historyduifangaaa.FromID.length-1),historyduifangaaa.FromID.length)==2||historyduifangaaa.FromID.substring((historyduifangaaa.FromID.length-1),historyduifangaaa.FromID.length)==8" class=" circle2" style=" position: absolute;left: 8px;font-size: 14px;padding-top: 8px">{{historyduifangaaa.FromName.length > 2 ? historyduifangaaa.FromName.substring((historyduifangaaa.FromName.length-2),historyduifangaaa.FromName.length):historyduifangaaa.FromName}}</div>
        <div ng-if="historyduifangaaa.FromID.substring((historyduifangaaa.FromID.length-1),historyduifangaaa.FromID.length)==3||historyduifangaaa.FromID.substring((historyduifangaaa.FromID.length-1),historyduifangaaa.FromID.length)==7" class=" circle3" style=" position: absolute;left: 8px;font-size: 14px;padding-top: 8px">{{historyduifangaaa.FromName.length > 2 ? historyduifangaaa.FromName.substring((historyduifangaaa.FromName.length-2),historyduifangaaa.FromName.length):historyduifangaaa.FromName}}</div>
        <div ng-if="historyduifangaaa.FromID.substring((historyduifangaaa.FromID.length-1),historyduifangaaa.FromID.length)==4||historyduifangaaa.FromID.substring((historyduifangaaa.FromID.length-1),historyduifangaaa.FromID.length)==6" class=" circle4" style=" position: absolute;left: 8px;font-size: 14px;padding-top: 8px">{{historyduifangaaa.FromName.length > 2 ? historyduifangaaa.FromName.substring((historyduifangaaa.FromName.length-2),historyduifangaaa.FromName.length):historyduifangaaa.FromName}}</div>
        <div ng-if="historyduifangaaa.FromID.substring((historyduifangaaa.FromID.length-1),historyduifangaaa.FromID.length)==5||historyduifangaaa.FromID.substring((historyduifangaaa.FromID.length-1),historyduifangaaa.FromID.length)==0" class=" circle5" style=" position: absolute;left: 8px;font-size: 14px;padding-top: 8px">{{historyduifangaaa.FromName.length > 2 ? historyduifangaaa.FromName.substring((historyduifangaaa.FromName.length-2),historyduifangaaa.FromName.length):historyduifangaaa.FromName}}</div>

        <p class="rj-message" style="margin-left: 14%;color: black;background-color: #FFFFFF;text-align: center" ><span style="color: #0d3349;font-size: 16px;">位置：</span>{{historyduifangaaa.Msg.substring(historyduifangaaa.Msg.indexOf(",",historyduifangaaa.Msg.indexOf(",")+1)+1,historyduifangaaa.Msg.length)}}</p>
        <div style="clear:both;float: left;margin-left: 14%;color:slategray;margin-top: -1px">接收时间：{{ historyduifangaaa.MsgDate | date:'yyyy-MM-dd HH:mm:ss'}}</div>

      </div>
      <div class="rj-message-wrap" ng-if="(historyduifangaaa.FromID == UserID)&&(historyduifangaaa.MsgType=='P')" style="margin-top: 10px">

        <div class="circle6" style=" position: absolute;left: 88%;top: 6%;font-size: 14px;text-align: center;padding-top: 8px">{{historyduifangaaa.FromName.length > 2 ? historyduifangaaa.FromName.substring((historyduifangaaa.FromName.length-2),historyduifangaaa.FromName.length):historyduifangaaa.FromName}}</div>



        <div style="float: right;margin-right: 10%;color: black; "><p class="rj-message-right" style="background-color: lightgoldenrodyellow;text-align: center"><span style="color: #0d3349;font-size: 16px;">位置：</span>{{historyduifangaaa.Msg.substring(historyduifangaaa.Msg.indexOf(",",historyduifangaaa.Msg.indexOf(",")+1)+1,historyduifangaaa.Msg.length)}}</p></div>

        <div style="clear:both;float: right;margin-right: 14%;color:slategray;margin-top: -1px">发送时间：{{ historyduifangaaa.MsgDate | date:'yyyy-MM-dd HH:mm:ss'}}</div>

      </div>

    </div>

  </ion-content>

</ion-view>
