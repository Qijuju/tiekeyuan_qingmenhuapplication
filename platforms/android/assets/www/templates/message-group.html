<ion-view id="messageGroupDetail" view-title={{chatname}}>
  <ion-nav-bar align-title="center">

    <ion-nav-buttons side="left">
      <button class="button  button-icon icon ion-ios-arrow-back" ng-click="backSecondMenu(grouptype)">
        即时通
      </button>
    </ion-nav-buttons>

    <ion-nav-buttons side="right">
      <button class="button button-icon icon ion-ios-people-outline" ng-click="goGroupDetail(groupid,chatname,grouptype,ismygroup)"
              style="margin-right: 5px"></button>
    </ion-nav-buttons>

  </ion-nav-bar>

  <ion-content class="rj-stable-content" delegate-handle="messageDetailsScroll" on-drag="onDrag()" ng-click="zhilinggroup()" id="contentbb">
    <ion-refresher refreshing-icon="ion-loading-c" on-refresh="doRefresh()" refreshing-text="获取数据中..."
                   pulling-text="更多消息" id="refresh">
    </ion-refresher>
    <p style="text-align: center" ng-if="nomore === 'true'" ng-click="skipgroupmessagebox()">更多消息请在历史消息中查阅</p>
    <div>
      <!--<p class="rj-message-time">5月27日 16:33</p>-->

      <div ng-repeat="msg in groupmsgs">
        <!--<div class="rj-message-wrap" ng-if="(msg.from==='false')">-->
          <!--<img src="img/mike.png" class="rj-head-pic">-->
          <!--<span class="rj-triangle-left"></span>-->
          <!--<p class="rj-message">{{msg.message}}</p>-->
        <!--</div>-->
        <div class="rj-message-wrap" ng-if="(msg.from==='false') && (msg.sessionid === groupid) &&(!(msg.messagetype.substr(0,5)==='Event'))">
          <div ng-if="msg.senderid.substring((msg.senderid.length-1),msg.senderid.length)==1||msg.senderid.substring((msg.senderid.length-1),msg.senderid.length)==9" class=" circle1" style=" position: absolute;left: 3%;font-size: 14px;padding-top: 9px" ng-click="godetail(msg.senderid)">{{msg.username.length > 2 ? msg.username.substring((msg.username.length-2),msg.username.length):msg.username}}</div>
          <div ng-if="msg.senderid.substring((msg.senderid.length-1),msg.senderid.length)==2||msg.senderid.substring((msg.senderid.length-1),msg.senderid.length)==8" class=" circle2" style=" position: absolute;left: 3%;font-size: 14px;padding-top: 9px" ng-click="godetail(msg.senderid)">{{msg.username.length > 2 ? msg.username.substring((msg.username.length-2),msg.username.length):msg.username}}</div>
          <div ng-if="msg.senderid.substring((msg.senderid.length-1),msg.senderid.length)==3||msg.senderid.substring((msg.senderid.length-1),msg.senderid.length)==7" class=" circle3" style=" position: absolute;left: 3%;font-size: 14px;padding-top: 9px" ng-click="godetail(msg.senderid)">{{msg.username.length > 2 ? msg.username.substring((msg.username.length-2),msg.username.length):msg.username}}</div>
          <div ng-if="msg.senderid.substring((msg.senderid.length-1),msg.senderid.length)==4||msg.senderid.substring((msg.senderid.length-1),msg.senderid.length)==6" class=" circle4" style=" position: absolute;left: 3%;font-size: 14px;padding-top: 9px" ng-click="godetail(msg.senderid)">{{msg.username.length > 2 ? msg.username.substring((msg.username.length-2),msg.username.length):msg.username}}</div>
          <div ng-if="msg.senderid.substring((msg.senderid.length-1),msg.senderid.length)==5||msg.senderid.substring((msg.senderid.length-1),msg.senderid.length)==0" class=" circle5" style=" position: absolute;left: 3%;font-size: 14px;padding-top: 9px" ng-click="godetail(msg.senderid)">{{msg.username.length > 2 ? msg.username.substring((msg.username.length-2),msg.username.length):msg.username}}</div>
          <!--<img src="img/mike.png" class="rj-head-pic">-->
          <span>
          <p class="rj-message" style="margin-left: 14.5%">{{msg.message}}</p>
          </span>
        </div>


        <div class="rj-message-wrap" ng-if="(msg.from === 'true') &&(msg.senderid === myUserID)">
          <div class="circle6" style=" position: absolute;left: 86%;top: 17px;font-size: 14px;text-align: center;padding-top: 9px">{{msg.username.length > 2 ? msg.username.substring((msg.username.length-2),msg.username.length):msg.username}}</div>
           <span>
             <!--<img style="margin-right: 5px;position: relative;right: 0px;" src="img/red.png" align="left">-->
             <p style="margin-right: 10.5%">
               <font class="rj-message-right" style="color: #ffffff">
                 <ion-spinner icon="ios-small"  style="background-color: transparent;margin-left: -35px;position: relative;vertical-align: middle" ng-if="msg.isSuccess === 'false'&& msg.isFailure === 'false' ">
                 </ion-spinner>
                 {{msg.message}}
               </font></p>
              <img class="rj-message-right" style="margin-right: -2%;background-color: transparent" src="img/red.png" ng-if="(msg.isFailure === 'true') && (msg.isSuccess === 'false')"  ng-click="resendgroupshow(groupid,msg.message,groupid,grouptype,localusr,myUserID,msg._id,msg)" />
          </span>
          <!--<img src="img/ben.png" class="rj-head-pic-right">-->
          <!--<span class="rj-triangle-right"></span>-->
          <!--<span>-->
             <!--&lt;!&ndash;<img style="margin-right: 5px;position: relative;right: 0px;" src="img/red.png" align="left">&ndash;&gt;-->
             <!--<p style="float: right;"><img style="vertical-align: middle;" src="img/red.png" ng-if="(msg.isFailure)==='true'" ng-click="resendgroupshow(groupid,msg.message,groupid,grouptype,localusr,myUserID,msg._id)"><font class="rj-message-right">{{msg.message}}</font></p>-->
          <!--</span>-->
        </div>
        <!--<div>-->
          <!--<p ng-if="msg.messagetype.substr(0,5)==='Event'" style="margin-top: 5px;" align="center">{{msg.message}}</p>-->
        <!--</div>-->
        <div>
          <p ng-if="msg.messagetype.substr(0,5)==='Event' && (msg.sessionid === groupid) " style="margin-top: 5px;" align="center">{{msg.message}}</p>
        </div>
      </div>

    </div>


  </ion-content>

  <ion-footer-bar class="bar-light" style="height: auto">
    <div class="rj-footer-btn-wrap" style="margin-top: 37px">
      <!--<button class="button button-icon icon ion-ios-mic-outline rj-footer-btn-left">-->
      <!--</button>-->
    </div>

    <div class="item-input rj-footer-btn-wrap" style="width: 72%" ng-click="zhilinggroup()">
      <textarea msd-elastic ng-model="send_content" style="margin-right: 45px">
      </textarea>
    </div>

    <div class="rj-footer-btn-wrap"><!--style="margin-left: 15px;margin-right: 5px"-->
      <div class="buttons rj-footer-btn-wrap" style="margin-top: 22px;width: 15px;height: 15px">
        <!--<button class="rj-footer-btn button button-icon icon ion-happy-outline"></button>-->
      </div>
      <div class="buttons" ng-show="!send_content || send_content === ''" ng-click="gengduogropu()">
        <button class="button button-icon icon ion-ios-plus-outline rj-footer-btn-left">
        </button>
      </div>
      <div class="rj-send-button" ng-hide="!send_content || send_content === ''"
           ng-click="sendSingleGroupMsg(groupid,send_content,groupid,grouptype,localusr,myUserID,_id)">
        <p>发送</p>
      </div>
    </div>
    <div ng-if="bgroup==1" style="height:200px;margin-left: -94%;margin-top: 5px">

      <div class="row" align="center">
        <!--<div id="butAlbum" ng-click="getPhoto('PHOTOLIBRARY',userId,send_content, userId,localusr,myUserID,_id)" class="col" align="center" style="padding: 16px">-->
        <div class="col" ng-click="takeGroupPhoto(groupid,send_content, groupid,localusr,myUserID,_id, grouptype)" align="center"
             style="padding: 15px">
          <!--<div class="col" ng-click="getPhoto('CAMERA',userId,send_content, userId,localusr,myUserID,_id)" align="center" style="padding: 15px">-->
          <a>
            <ul>
              <li style="height: 50px;width: 50px;align-content: center" class="squareliao1"><img src="img/paizhao.png"
                                                                                                  style="width: 28px;height: 28px;align-content: center;margin-top: 9px">
              </li>
              <li style="color: #848484;font-size: 10px">拍照</li>
            </ul>
          </a>
        </div>
        <div id="butAlbum" ng-click="openGroupDocumentWindow('image', groupid,send_content, groupid,localusr,myUserID,_id, grouptype)"
             class="col" align="center" style="padding: 15px">
          <!--<div id="butAlbum" ng-click="getPhoto('PHOTOLIBRARY',userId,send_content, userId,localusr,myUserID,_id)" class="col" align="center" style="padding: 15px">-->
          <a>
            <ul>
              <li style="height: 50px;width: 50px;align-content: center" class="squareliao1"><img src="img/tupian.png"
                                                                                                  style="width: 28px;height: 28px;align-content: center;margin-top: 9px">
              </li>
              <li style="color: #848484;font-size: 10px">相册</li>
            </ul>
          </a>
        </div>
        <div class="col" align="center"
             ng-click="openGroupDocumentWindow('*', groupid,send_content, groupid,localusr,myUserID,_id, grouptype)"
             style="padding: 15px">
          <a>
            <ul>
              <li style="height: 50px;width: 50px;align-content: center" class="squareliao1"><img src="img/wenjian.png"
                                                                                                  style="width: 28px;height: 28px;align-content: center;margin-top: 9px">
              </li>
              <li style="color: #848484;font-size: 10px">文件</li>
            </ul>
          </a>
        </div>
        <div class="col" align="center" style="padding: 15px"
             ng-click="gogegrouplocation('LOCATION',groupid,send_content, groupid,localusr,myUserID,_id,groupType)"
             >
          <a>
            <ul>
              <li style="height: 50px;width: 50px;align-content: center" class="squareliao1"><img src="img/dingwei.png"
                                                                                                  style="width: 28px;height: 28px;align-content: center;margin-top: 9px">
              </li>
              <li style="color: #848484;font-size: 10px">定位</li>
            </ul>
          </a>
        </div>

      </div>
      <!--<div class="row" style="margin-top: -22%">-->
      <!--<div class="col" align="center" ng-click="openDocumentWindow('video', userId,send_content, userId,localusr,myUserID,_id)" style="padding: 15px">-->
      <!--<a>-->
      <!--<ul>-->
      <!--<li style="height: 50px;width: 50px;align-content: center" class="squareliao1"><img src="img/shipin.png" style="width: 28px;height: 28px;align-content: center;margin-top: 9px"></li>-->
      <!--<li style="color: #848484;font-size: 10px">视频</li>-->
      <!--</ul>-->
      <!--</a>-->
      <!--</div>-->
      <!--<div class="col" align="center" ng-click="openDocumentWindow('audio', userId,send_content, userId,localusr,myUserID,_id)" style="padding: 15px">-->
      <!--<a>-->
      <!--<ul>-->
      <!--<li style="height: 50px;width: 50px;align-content: center" class="squareliao1"><img src="img/yinpin.png" style="width: 28px;height: 28px;align-content: center;margin-top: 9px"></li>-->
      <!--<li style="color: #848484;font-size: 10px">音频</li>-->
      <!--</ul>-->
      <!--</a>-->
      <!--</div>-->
      <!--<div class="col" align="center" style="padding: 15px">-->
      <!--<a>-->
      <!--<ul>-->
      <!--<li style="height: 50px;width: 50px;align-content: center"> </li>-->
      <!--<li style="color: #848484;font-size: 10px"> </li>-->
      <!--</ul>-->
      <!--</a>-->
      <!--</div>-->
      <!--<div class="col" align="center" style="padding: 15px">-->
      <!--<a>-->
      <!--<ul>-->
      <!--<li style="height: 50px;width: 50px;align-content: center"> </li>-->
      <!--<li style="color: #848484;font-size: 10px"> </li>-->
      <!--</ul>-->
      <!--</a>-->
      <!--</div>-->
    </div>
  </ion-footer-bar>
</ion-view>
