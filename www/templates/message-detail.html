<ion-view id="messageDetail" view-title={{viewtitle}} class="common-view-color">
  <ion-nav-bar  align-title="center" class="newbarhead ">
    <ion-nav-buttons side="left"">

    <button class="button  button-icon icon ion-ios-arrow-left common-color-white" ng-click="backFirstMenu(groupType)">

    </button>

    </ion-nav-buttons>

    <ion-nav-buttons side="right">
      <div align="center" style="margin-top: 7px">
        <img src="img/laba.png" style="height:18px;margin-right: 12px" ng-if="showsingleTingtong =='false'" ng-click="openSingleYangshengqiMode();"/>
        <img src="img/tingt.png" style="height:18px;margin-right: 12px"  ng-if="showsingleTingtong =='true'" ng-click="openSingleTingtongMode();"/>
        <img src="img/phone.png" style="height:18px;margin-right: 12px" ng-click="callperson()" />
        <img src="img/dtx.png" ng-click="personalSetting()" style="margin-right: 10px;height:18px" />
      </div>

    </ion-nav-buttons>
  </ion-nav-bar>

  <div style="position:fixed;left: 0px;right: 0px;top: 0px;bottom: 0px;width: 150px;height: 160px;margin: auto;background-color: #2c2c2c;z-index: 1000;text-align:center;" class="yuanjiao"
    ng-if="isShow === 'true'">
    <!---若录音时间小于1s，则展示这个--->
    <img style="padding-top:20px;width:100px;height: 100px;" ng-show= "isshowless ==='true'" src="img/chat_icon_voice_short.png"/>

    <!---分贝的六个等级--->
    <!--<img style="padding-top:20px;width:100px;height: 100px;" ng-show="rate ===0" src="img/chat_icon_voice1.png" />-->
    <img style="padding-top:20px;width:100px;height: 100px;" ng-show="isshowless === 'false' && rate ===0" src="img/chat_icon_voice2.png" />
    <img style="padding-top:20px;width:100px;height: 100px;" ng-show="isshowless === 'false' && rate ===1" src="img/chat_icon_voice3.png" />
    <img style="padding-top:20px;width:100px;height: 100px;" ng-show="isshowless === 'false' && rate ===2" src="img/chat_icon_voice4.png" />
    <img style="padding-top:20px;width:100px;height: 100px;" ng-show="isshowless === 'false' && rate ===3" src="img/chat_icon_voice5.png" />
    <img style="padding-top:20px;width:100px;height: 100px;" ng-show="(isshowless === 'false')&& (rate ===4 || rate ===5)"src="img/chat_icon_voice6.png" />
    <img style="padding-top:20px;width:100px;height: 100px;" ng-show="(isshowless === 'back')"src="img/back.png" />
    <br />
    <p style="color: #FFFFFF;size: 13px;margin-right: auto;margin-right: auto;margin-top: 10px;" align="center" ng-show="isshowless ==='false' && (rate >= 0 && rate <=6)">手指上滑,取消发送</p>
    <p style="color: #FFFFFF;size: 13px;margin-right: auto;margin-right: auto;margin-top: 10px;background: #ffa199;text-align: center;margin-left: 8px;margin-right: 8px;" align="center" ng-show="isshowless ==='back'">松开手指,取消发送</p>
    <!---若录音时间小于1s，则展示这个--->
    <p style="color: #FFFFFF;size: 13px;margin-right: auto;margin-right: auto;margin-top: 10px;" align="center" ng-show= "isshowless ==='true'">说话时间太短</p>
  </div>
  <ion-content class="rj-stable-content" delegate-handle="messageDetailsScroll" on-drag="onDrag()" ng-click="zhiling()"
               id="contentaa">
    <ion-refresher refreshing-icon="ion-loading-c" on-refresh="doRefresh()" refreshing-text="正在加载···"
                   pulling-text="释放加载" id="refresh"></ion-refresher>
    <p style="text-align: center" ng-if="nomore === 'true'" ng-click="skipmessagebox()">更多消息请在历史消息中查阅</p>










    <div ng-repeat="msgSingle in msgs" style="margin: 0px auto;padding: 0px auto;padding-top: 10px;">
      <!--1、发送与接收的时间戳-->
      <div class="row" ng-if="msgSingle.istime === 'true' ">
        <div class="col" style="text-align: center;vertical-align: middle;">
          <span style="text-align: center;vertical-align: middle;border-radius: 3px;background: lightgrey;padding: 2px;padding-left:4px;padding-right:4px;color: #ffffff;font-size: 12px;width: 100px;">{{msgSingle.daytype ==='1' ? (msgSingle.when | date:'HH:mm') : (msgSingle.when | date:'yyyy-MM-dd HH:mm')}}</span>
        </div>
      </div>

      <!--接收-->
      <!--2、对方的消息-->
      <div class="row" ng-if="(msgSingle.from==='false') &&(msgSingle.sessionid === userId)" style="float: left;">
        <div class="col col-12" ng-click="godetail(msgSingle.sessionid)" ng-if="otheryoumeiyou" >
        <img  src="{{otherheadpicurl}}" class="yuanjiao4">
      </div>
        <!--头像-->
        <div class="col col-12" ng-click="godetail(msgSingle.sessionid)" ng-if="(msgSingle.sessionid.substring((msgSingle.sessionid.length-1),msgSingle.sessionid.length)==1||msgSingle.sessionid.substring((msgSingle.sessionid.length-1),msgSingle.sessionid.length)==9)&&(!otheryoumeiyou)")><button class="circle1" style="border: none;font-size: 12px;">{{msgSingle.username.length > 2 ?
          msgSingle.username.substring((msgSingle.username.length-2),msgSingle.username.length):msgSingle.username}}</button></div>
        <div class="col col-12" ng-click="godetail(msgSingle.sessionid)" ng-if="(msgSingle.sessionid.substring((msgSingle.sessionid.length-1),msgSingle.sessionid.length)==2||msgSingle.sessionid.substring((msgSingle.sessionid.length-1),msgSingle.sessionid.length)==8)&&(!otheryoumeiyou)")><button class="circle2" style="border: none;font-size: 12px;">{{msgSingle.username.length > 2 ?
          msgSingle.username.substring((msgSingle.username.length-2),msgSingle.username.length):msgSingle.username}}</button></div>
        <div class="col col-12" ng-click="godetail(msgSingle.sessionid)" ng-if="(msgSingle.sessionid.substring((msgSingle.sessionid.length-1),msgSingle.sessionid.length)==3||msgSingle.sessionid.substring((msgSingle.sessionid.length-1),msgSingle.sessionid.length)==7)&&(!otheryoumeiyou)")><button class="circle3" style="border: none;font-size: 12px;">{{msgSingle.username.length > 2 ?
          msgSingle.username.substring((msgSingle.username.length-2),msgSingle.username.length):msgSingle.username}}</button></div>
        <div class="col col-12" ng-click="godetail(msgSingle.sessionid)" ng-if="(msgSingle.sessionid.substring((msgSingle.sessionid.length-1),msgSingle.sessionid.length)==4||msgSingle.sessionid.substring((msgSingle.sessionid.length-1),msgSingle.sessionid.length)==6)&&(!otheryoumeiyou)")><button class="circle4" style="border: none;font-size: 12px;">{{msgSingle.username.length > 2 ?
          msgSingle.username.substring((msgSingle.username.length-2),msgSingle.username.length):msgSingle.username}}</button></div>
        <div class="col col-12" ng-click="godetail(msgSingle.sessionid)" ng-if="(msgSingle.sessionid.substring((msgSingle.sessionid.length-1),msgSingle.sessionid.length)==5||msgSingle.sessionid.substring((msgSingle.sessionid.length-1),msgSingle.sessionid.length)==0)&&(!otheryoumeiyou)")><button class="circle5" style="border: none;font-size: 12px;">{{msgSingle.username.length > 2 ?
          msgSingle.username.substring((msgSingle.username.length-2),msgSingle.username.length):msgSingle.username}}</button></div>
        <!--接收###文本内容-->
        <div class="col" ng-if="msgSingle.messagetype === 'normal' || msgSingle.messagetype === 'Text'">
          <div class="rj-message-new-left" on-hold="longtab({{msgSingle}})" style="max-width:250px;width: auto !important;text-align:center;height:auto;float: left;color: black"><p style="text-align: left;padding: 0 auto;">{{msgSingle.message}}</p></div>
        </div>
        <!--图片内容-->
        <div class="col" ng-if="msgSingle.messagetype === 'Image' || (msgSingle.messagetype === 'File' && getFileType(msgSingle.message))">
          <img style="background-color: transparent;border-radius: 10px;width: 110px;" src="{{msgSingle.message.split('###')[1]}}" ng-click="netScaleImage(msgSingle.message.split('###')[0],msgSingle.message.split('###')[4],msgSingle.message.split('###')[1])" />
        </div>
        <!--接收###文件内容-->
        <div class="col" ng-if="msgSingle.messagetype === 'File' && !getFileType(msgSingle.message) && !isMsgVideo(msgSingle.message.split('###')[1])">
          <div class="row item" style="width: 230px!important;border-radius: 3px;" ng-click="openAllFile(msgSingle.message.split('###')[1], msgSingle)">
            <div class="col-20"><img src="{{getFileTypeImg(msgSingle.message)}}"
                                     style="width: 55px;height: 55px;"/></div>
            <div class="col" style="margin-top: 5px;margin-bottom: -10px;">
              <h2 style="font-size: 10px;margin-left: 7px;padding-bottom: 8px;margin-right: 50px;overflow: hidden;">{{getFileName(msgSingle.message)}}</h2>
              <!--进度条-->
              <div ng-show="msgSingle.message.split('###')[5] != '0' && msgSingle.message.split('###')[5] != '100' && msgSingle.message.split('###')[5] != '-1'" class="outbar" style="margin-left: 7px;"><div class="inbar" style="width:{{msgSingle.message.split('###')[5]}}%;background:#5CB85C;"></div></div>
              <!--进度百分比-->
              <div ng-show="msgSingle.message.split('###')[5] != '0' && msgSingle.message.split('###')[5] != '100' && msgSingle.message.split('###')[5] != '-1'" style="font-size: 10px;margin-left: 2px;height: 10px;margin-top:-4px;float: left;">{{msgSingle.message.split('###')[5]}}%</div>
              <!--接收成功-->
              <div ng-show="msgSingle.message.split('###')[5] === '100'" style="font-size: 10px;margin-left: 7px;height: 10px;margin-top:-4px;float: left;color: #5CB85C;">{{msgSingle.message.split('###')[3]}}</div>
              <!--接收失败-->
              <div ng-show="msgSingle.message.split('###')[5] === '-1'" style="font-size: 10px;margin-left: 7px;height: 10px;margin-top:-4px;float: left;color: #ee0500;">接收失败！</div>
              <!--未下载-->
              <div ng-show="msgSingle.message.split('###')[5] === '0'" style="font-size: 10px;margin-left: 7px;height: 10px;margin-top:-4px;float: left;color: #ee0500;">未下载</div>
            </div>
          </div>
        </div>
        <!--接收###视频内容-->
        <div class="col" ng-if="msgSingle.messagetype === 'Vedio' || isMsgVideo(msgSingle.message.split('###')[1])">
          <div style="width: 250px;float: left;">
            <video style="width: 100%;height:100%;" controls preload="auto">
              <source style="height: 100%;width: 100%;background-color: #DD5044" src="{{msgSingle.message.split('###')[1]}}" type="video/mp4">
            </video>
          </div>
        </div>
        <!--接收###音频内容-->
        <div class="col" ng-if="msgSingle.messagetype === 'Audio'" style="vertical-align: middle !important;">
          <div class="rj-message-voice-left" ng-click="showanimation(msgSingle.message.split('###')[1], msgSingle._id,msgSingle.isread);" style="max-width:250px;width: {{((msgSingle.message.split('###')[2] - msgSingle.message.split('###')[2]%1000)/1000) < 7 ? 40 :(((msgSingle.message.split('###')[2] - msgSingle.message.split('###')[2]%1000)/1000)*7) }}px !important;text-align:left;vertical-align: middle !important;height:auto;float: left;">
            <img src="img/turnrightstatic.jpg" style="height: 25px;" class="yuanjiao" align="left" ng-show="msgSingle._id != audioid || isshowgPng === 'true'"/>
            <img src="img/turnright.gif" style="height: 25px;" class="yuanjiao" align="left" ng-show="isshowgif === 'true' && msgSingle._id === audioid && audioid != undefined && audioid != null && audioid != ''"/>
          </div>
          <div class="row" style="max-width:250px;width: auto !important;text-align:center;height:auto;float: left;margin-left: -5px;">
            <div class="col col-center item" style="background: none !important; border: none;">
              <div class="row row-center item" style="background: none !important; border: none;vertical-align: top !important;margin-top:-8px;margin-bottom: 8px;">
                <img src="img/redpoint.png" style="height: 8px;width: 8px;margin-left: 3px;margin-top: 0px;padding-top: 0px;" ng-if="msgSingle.messagetype === 'Audio'&&msgSingle.isread === '0'"/>
              </div>
              <div class="row row-center item" style="background: none !important; border: none;">
                {{(msgSingle.message.split('###')[2] - msgSingle.message.split('###')[2]%1000)/1000}}"
              </div>
            </div>
          </div>
        </div>
        <!--接收###地图内容-->
        <div class="col" ng-if="msgSingle.messagetype === 'LOCATION'">
          <div class="row item" style="width: 230px!important;border-radius: 3px;" ng-click="entermap(msgSingle.message)">
            <div class="col-20"><img src="img/location.jpg"
                                     style="width: 45px;height: 55px;margin-left: 5px;"/></div>
            <div class="col" style="margin-top: 5px;margin-bottom: -10px;">
              <h2 style="font-size: 10px;margin-left: 7px;padding-bottom: 8px;margin-right: 50px;overflow: hidden;">{{msgSingle.message.split(',')[2]}}</h2>
              <!--进度条-->
              <div class="outbar" style="margin-left: 7px;display: none;"><div class="inbar" style="width:70%;background:#5CB85C;display: none;"></div></div>
              <!--进度百分比-->
              <div style="font-size: 10px;margin-left: 2px;height: 10px;margin-top:-4px;float: left;display: none;">70%</div>
              <!--接收成功-->
              <div style="font-size: 10px;margin-left: 7px;height: 10px;margin-top:-4px;float: left;color: #5CB85C;">已接收</div>
              <!--接收失败-->
              <div style="font-size: 10px;margin-left: 7px;height: 10px;margin-top:-4px;float: left;color: #ee0500;display: none;">发送失败！</div>
            </div>
          </div>
        </div>

      </div>







      <!--发送-->
      <!--3、我的消息-->
      <div ng-if="(msgSingle.from === 'true') &&(msgSingle.senderid === myUserID)" class="row" style="float: right;">
        <!--发送###文本内容-->
        <div class="col" ng-if="msgSingle.messagetype === 'normal' || msgSingle.messagetype === 'Text'">
          <div class="rj-message-new-right" style="max-width:250px;width: auto !important;height:auto;float: right;text-align: center;background: #38ADFF;color: #ffffff;" on-hold="longtab({{msgSingle}})"><p style="text-align: left;padding: 0 auto;">{{msgSingle.message}}</p></div>
          <!--容错处理-->
          <div class="row" style="max-width:250px;width: auto !important;text-align:center;height:auto;float: right;margin-right: -5px;">
            <div class="col col-center item" ng-if="msgSingle.isFailure ==='true'" style="background: none !important; border: none;float: right;">
              <img src="img/red.png" align="center" ng-click="resendshow(userId,msgSingle.message, userId, localusr,myUserID,msgSingle._id,msgSingle)" />
            </div>
            <div class="col col-center item" ng-if="msgSingle.isSuccess === 'false'&& msgSingle.isFailure === 'false' " style="background: none !important; border: none;float: right;">
              <ion-spinner icon="ios-small"
                           style="background-color: transparent;vertical-align: middle"></ion-spinner>
            </div>
          </div>
        </div>

        <!--发送###图片内容-->
        <div class="col" ng-if="msgSingle.messagetype === 'Image' || (msgSingle.messagetype === 'File' && getFileType(msgSingle.message))">
          <img style="background-color: transparent;border-radius: 10px;width: 110px;float: right;" src="{{msgSingle.message.split('###')[1]}}" ng-click="boostImage(msgSingle.message.split('###')[1])" align="center" />
          <!--容错处理-->
          <div class="row" style="max-width:250px;width: auto !important;text-align:center;height:auto;float: right;margin-right: -5px;">
            <div class="col col-center item" ng-if="msgSingle.isFailure ==='true'" style="background: none !important; border: none;float: right;">
              <img src="img/red.png" align="center" ng-click="resendshow(userId,msgSingle.message, userId, localusr,myUserID,msgSingle._id,msgSingle)" />
            </div>
            <div class="col col-center item" ng-if="msgSingle.isSuccess === 'false'&& msgSingle.isFailure === 'false' " style="background: none !important; border: none;float: right;">
              <ion-spinner icon="ios-small"
                           style="background-color: transparent;vertical-align: middle"></ion-spinner>
            </div>
          </div>
        </div>
        <!--发送###文件内容-->
        <div class="col" ng-if="msgSingle.messagetype === 'File' && !getFileType(msgSingle.message) && !isMsgVideo(msgSingle.message.split('###')[1])">
          <div class="row item" style="width: 230px!important;border-radius: 3px;float: right;" ng-click="openAllFile(msgSingle.message.split('###')[1],msgSingle)">
            <div class="col-20"><img src="{{getFileTypeImg(msgSingle.message)}}"
                                     style="width: 55px;height: 55px;"/></div>
            <div class="col" style="margin-top: 5px;margin-bottom: -10px;">
              <h2 style="font-size: 10px;margin-left: 7px;padding-bottom: 8px;margin-right: 50px;overflow: hidden;">{{msgSingle.message.split('###')[4]}}</h2>
              <!--进度条-->
                <div ng-show="msgSingle.message.split('###')[5] != '100' && msgSingle.message.split('###')[5] != '-1'" class="outbar" style="margin-left: 7px;"><div class="inbar" style="width:{{msgSingle.message.split('###')[5]}}%;background:#5CB85C;"></div></div>
              <!--进度百分比-->
              <div ng-show="msgSingle.message.split('###')[5] != '100' && msgSingle.message.split('###')[5] != '-1'" style="font-size: 10px;margin-left: 2px;height: 10px;margin-top:-4px;float: left;">{{msgSingle.message.split('###')[5]}}%</div>
              <!--发送成功-->
              <div ng-if="msgSingle.isFailure === 'false' && msgSingle.message.split('###')[5] === '100'" style="font-size: 10px;margin-left: 7px;height: 10px;margin-top:-4px;float: left;color: #5CB85C;">{{msgSingle.message.split('###')[3]}}</div>
              <!--发送失败-->
              <div ng-if="msgSingle.isFailure === 'true' || msgSingle.message.split('###')[5] === '-1'" style="font-size: 10px;margin-left: 7px;height: 10px;margin-top:-4px;float: left;color: #ee0500;">发送失败！</div>
            </div>
          </div>
          <!--容错处理-->
          <div class="row" style="max-width:250px;width: auto !important;text-align:center;height:auto;float: right;margin-right: -5px;">
            <div class="col col-center item" ng-if="msgSingle.isFailure ==='true'" style="background: none !important; border: none;float: right;">
              <img src="img/red.png" align="center" ng-click="resendshow(userId,msgSingle.message, userId, localusr,myUserID,msgSingle._id,msgSingle)" />
            </div>
            <div class="col col-center item" ng-if="msgSingle.isSuccess === 'false'&& msgSingle.isFailure === 'false' " style="background: none !important; border: none;float: right;">
              <ion-spinner icon="ios-small"
                           style="background-color: transparent;vertical-align: middle"></ion-spinner>
            </div>
          </div>
        </div>
        <!--发送###视频内容-->
        <div class="col" ng-if="msgSingle.messagetype ==='Vedio' || isMsgVideo(msgSingle.message.split('###')[1])">
          <div style="width: 250px;float: right;">
            <video id="vedio1" style="width: 100%;height:100%;" ng-if="msgSingle.message.split('###')[5] != '100'" preload="auto">
              <source style="height: 100%;width: 100%;background-color: #DD5044" src="{{msgSingle.message.split('###')[1]}}" type="video/mp4">
            </video>
            <video id="vedio" style="width: 100%;height:100%;" ng-if="msgSingle.message.split('###')[5] === '100'" controls preload="auto">
              <source style="height: 100%;width: 100%;background-color: #DD5044" src="{{msgSingle.message.split('###')[1]}}" type="video/mp4">
            </video>
            <div style="width: 100%;height:100%;margin-top: -7px;">
              <div ng-show="msgSingle.message.split('###')[5] != '0' && msgSingle.message.split('###')[5] != '100' && msgSingle.message.split('###')[5] != '-1'" class="outbar" style="width: 100%;"><div class="inbar" style="width:{{msgSingle.message.split('###')[5]}}%;background:#5CB85C;"></div></div>
            </div>
          </div>
          <!--容错处理-->
          <div class="row" style="max-width:250px;width: auto !important;text-align:center;height:auto;float: right;margin-right: -5px;">
            <div class="col col-center item" ng-if="msgSingle.isFailure ==='true'" style="background: none !important; border: none;float: right;">
              <img src="img/red.png" align="center" ng-click="resendshow(userId,msgSingle.message, userId, localusr,myUserID,msgSingle._id,msgSingle)" />
            </div>
          </div>
        </div>
        <!--发送###音频内容-->
        <div class="col" ng-if="msgSingle.messagetype === 'Audio'">
          <div class="rj-message-voice-left" style="max-width:250px;width: {{((msgSingle.message.split('###')[2] - msgSingle.message.split('###')[2]%1000)/1000) < 7 ? 40 :(((msgSingle.message.split('###')[2] - msgSingle.message.split('###')[2]%1000)/1000)*7) }}px !important;text-align:right;vertical-align: middle !important;height:auto;background: #38ADFF;float: right;" ng-click="showanimation(msgSingle.message.split('###')[1], msgSingle._id);">
            <img src="img/turnleftstatic.png" style="height: 25px;" class="yuanjiao" align="right" ng-show="msgSingle._id != audioid || isshowgPng === 'true'"/>
            <img src="img/turnleft.gif" style="height: 25px;" class="yuanjiao" align="right" ng-show="isshowgif === 'true' && msgSingle._id === audioid && audioid != undefined && audioid != null && audioid != ''"/>
          </div>
          <div class="row" style="max-width:250px;width: auto !important;text-align:center;height:auto;float: right;margin-right: -5px;">
            <div class="col col-center item" style="background: none !important; border: none;float: right;">
              <div class="row row-center item" style="background: none !important; border: none;float: right;">
                {{(msgSingle.message.split('###')[2] - msgSingle.message.split('###')[2]%1000)/1000}}"
              </div>
            </div>
          </div>
          <!--容错处理-->
          <div class="row" style="max-width:250px;width: auto !important;text-align:center;height:auto;float: right;margin-right: -5px;">
            <div class="col col-center item" ng-if="msgSingle.isFailure ==='true'" style="background: none !important; border: none;float: right;">
              <img src="img/red.png" align="center" ng-click="resendshow(userId,msgSingle.message, userId, localusr,myUserID,msgSingle._id,msgSingle)" />
            </div>
            <div class="col col-center item" ng-if="msgSingle.isSuccess === 'false'&& msgSingle.isFailure === 'false' " style="background: none !important; border: none;float: right;">
              <ion-spinner icon="ios-small"
                           style="background-color: transparent;vertical-align: middle"></ion-spinner>
            </div>
          </div>
        </div>
        <!--发送###地图内容-->
        <div class="col" ng-if="msgSingle.messagetype === 'LOCATION'">
          <div class="row item" style="width: 230px!important;border-radius: 3px;float: right;" ng-click="entermap(msgSingle.message.substring(0, msgSingle.message.lastIndexOf(',')))">
            <div class="col-20"><img src="img/location.jpg"
                                     style="width: 45px;height: 55px;margin-left: 5px;"/></div>
            <div class="col" style="margin-top: 5px;margin-bottom: 5px;">
              <h2 style="font-size: 10px;margin-left: 7px;padding-bottom: 8px;margin-right: 50px;overflow: hidden;">{{msgSingle.message.split(',')[2]}}</h2>
              <!--进度条-->
              <div class="outbar" style="margin-left: 7px;display: none;"><div class="inbar" style="width:70%;background:#5CB85C;"></div></div>
              <!--进度百分比-->
              <div style="font-size: 10px;margin-left: 2px;height: 10px;margin-top:-4px;float: left;display: none;">70%</div>
              <!--发送成功-->
              <div style="font-size: 10px;margin-left: 7px;height: 10px;margin-top:-4px;float: left;color: #5CB85C;">点击查看</div>
              <!--发送失败-->
              <div style="font-size: 10px;margin-left: 7px;height: 10px;margin-top:-4px;float: left;color: #ee0500;display: none;">发送失败！</div>
            </div>
          </div>
          <!--容错处理-->
          <div class="row" style="max-width:250px;width: auto !important;text-align:center;height:auto;float: right;margin-right: -5px;">
            <div class="col col-center item" ng-if="msgSingle.isFailure ==='true'" style="background: none !important; border: none;float: right;">
              <img src="img/red.png" align="center" ng-click="resendshow(userId,msgSingle.message, userId, localusr,myUserID,msgSingle._id,msgSingle)" />
            </div>
            <div class="col col-center item" ng-if="msgSingle.isSuccess === 'false'&& msgSingle.isFailure === 'false' " style="background: none !important; border: none;float: right;">
              <ion-spinner icon="ios-small"
                           style="background-color: transparent;vertical-align: middle"></ion-spinner>
            </div>
          </div>
        </div>
      </div>
    </div>
    <br />
    <div>&nbsp;</div>


  </ion-content>

  <ion-footer-bar class="bar-light" style="height: auto;padding: 0 0;margin:0 0;">
    <div style="height: auto;width: 100%;">
      <div style="height: 50px;width: 100%;background-color: #F5F5F5">
        <div align="left" style="position: relative;width: 10%;height: 80%;display: inline-block;top:5px;left:5px;right: 5px;">
          <div ng-click="clickOn()" ng-hide="isYuYin === 'true'" style="height: 40px;width:40px;bottom:5px;position: absolute;">
            <md-icon  class="icon ion-ios-mic-outline rj-footer-btn-left" style="border: none;background-color: #F5F5F5;font-size:28px;line-height:1;position:relative;left:12px;"  >
            </md-icon>
          </div>
          <img src="img/keyborad.png" class="icon ion-ios-mic-outline rj-footer-btn-left " style="width: 36px;height: 36px;position: relative;bottom: 2px;left: 2px;" ng-show="isYuYin === 'true'" ng-click="clickOnChange()" />
        </div>
        <div align="center" style="position: relative;width: 76%;height: 80%;display: inline-block;top: 5px;left: 5px;right: 5px;">
          <div style="width: 100%;height: 100%;" ng-show="isYuYin === 'true'">
            <button style="width: 100%;height: 100%;position: absolute;bottom: 0px;left: 0px;right: 0px;top: 0px;border: none;border:1px solid #F5F5F5;border-radius: 5px;" on-touch="showYuyin('Audio',_id)" on-release="releaseYuyin('Audio',_id)" on-drag="onDragVoiceBtn($event)">
            <font style="font-size: 15px;">按住 说话</font>
            </button>
          </div>
          <div style="width: 100%;height: 100%;" ng-show="isYuYin != 'true'" ng-click="zhiling()">
            <textarea style="width: 100%;height: 40px;border: 1px solid #F5F5F5;border-radius: 5px;font-size: 16px;padding-top: 10px;padding-left: 3px" rows="3" contenteditable="false" ng-model="send_content" >
            </textarea>
          </div>
        </div>
        <div align="right" style="position: relative;width: 10%;height: 80%;display: inline-block;top: 5px;left: 5px;right: 5px;">

          <div class="buttons" ng-show="!send_content || send_content === ''"
               style="width: 80%;height:80%;position: absolute;bottom: 0px;" ng-click="gengduo()">
            <button class="button-icon icon ion-ios-plus-outline"   style="position:absolute;right:85%;
            bottom:2px;" >
            </button>
          </div>


          <div ng-hide="!send_content || send_content === ''" style="width: 80%;height:80%;position: absolute;bottom: 0px;"
               ng-click="sendSingleMsg(userId,send_content, userId,localusr,myUserID,_id)">
            <p>发送</p>
          </div>
        </div>

      </div>

      <div ng-if="a==1" style="height: 170px;width: 100%;background-color: white">
        <div class="row" style="width:100%;height: 85px;">
          <div class="col col-25" align="center" style="margin:auto 0" ng-click="takePhoto(userId,send_content, userId,localusr,myUserID,_id)">
            <ul>
              <li style="height: 50px;width: 50px;align-content: center" >
                <img src="img/ddpaizhao.png" style="width: 48px;height: 48px;align-content: center;">
              </li>
              <li style="color: #b2b2b2;font-size: 12px">拍照</li>
              </ul>
          </div>
          <div class="col col-25" align="center" style="margin: auto 0" ng-click="openDocumentWindow('image', userId,send_content, userId,localusr,myUserID,_id)">
            <ul>
              <li style="height: 50px;width: 50px;align-content: center" >
                <img src="img/ddtupian.png" style="width: 48px;height: 48px;align-content: center;">
              </li>
              <li style="color: #b2b2b2;font-size: 12px">相册</li>
            </ul>
          </div>
          <div class="col col-25" align="center" style="margin:auto 0" ng-click="takeVideo(userId,send_content, userId,localusr,myUserID,_id)" >
            <ul>
              <li style="height: 50px;width: 50px;align-content: center" >
                <img src="img/ddxiaoshipin.png" style="width: 48px;height: 48px;align-content: center;">
              </li>
              <li style="color: #b2b2b2;font-size: 12px">视频</li>
            </ul>
          </div>
          <div class="col col-25" align="center" style="margin: auto 0" ng-click="gogelocation('LOCATION',userId,send_content, userId,localusr,myUserID,_id,groupType)">
            <ul>
              <li style="height: 50px;width: 50px;align-content: center" >
                <img src="img/dddingwei.png" style="width: 48px;height: 48px;align-content: center;">
              </li>
              <li style="color:#b2b2b2;font-size: 12px">定位</li>
            </ul>
          </div>
        </div>
        <div class="row" style="width:100%;height: 85px;"  ng-click="openDocumentWindow('*', userId,send_content, userId,localusr,myUserID,_id)"  >
          <div class="col col-25" align="center" style="margin: 7px 0" >
            <ul>
              <li style="height: 50px;width: 50px;align-content: center" >
                <img src="img/ddwenjian.png" style="width: 48px;height: 48px;align-content: center;">
              </li>
              <li style="color: #b2b2b2;font-size: 12px">文件</li>
            </ul>
          </div>
          <div class="col col-25" align="center" style="margin:auto 0"></div>
          <div class="col col-25" align="center" style="margin:auto 0"></div>
          <div class="col col-25" align="center" style="margin:auto 0"></div>
        </div>
      </div>
    </div>


  </ion-footer-bar>


</ion-view>

